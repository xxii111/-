function data=generate_gmm()
N = 700;
para_pi = [0.2,0.2,0.1,0.2,0.1,0.2];
u1 = [1,1];
s1 = [1 0;0 0.64];
data1 = mvnrnd(u1, s1, para_pi(1)*N);
u2 = [1,5];
s2 = [1 0;0 0.49];
data2 = mvnrnd(u2, s2, para_pi(2)*N);
u3 = [5,1];
s3 = [0.64 0;0 0.64];
data3 = mvnrnd(u3, s3, para_pi(3)*N);
u4 = [5,5];
s4 = [0.64 0;0 0.49];
data4 = mvnrnd(u4, s4, para_pi(4)*N);
u5 = [-3,1];
s5 = [0.81 0;0 0.64];
data5 = mvnrnd(u5, s5, para_pi(5)*N);
u6 = [-6,5];
s6 = [0.81 0;0 0.49];
data6 = mvnrnd(u6, s6, para_pi(6)*N);
figure(1)
scatter(data1(:,1),data1(:, 2),'b.');
hold on;
scatter(data2(:,1),data2(:,2),'r.');
scatter(data3(:,1),data3(:,2),'g.');
scatter(data4(:,1),data4(:,2),'y.');
scatter(data5(:,1),data5(:,2),'m.');
scatter(data6(:,1),data6(:,2),'c.');
legend("Z_1","Z_2","Z_3","Z_4","Z_5","Z_6")
title('离散信源分布图');
data = [data1;data2;data3;data4;data5;data6];
% ux = [1,5,-3,-6];
% uy = [1,5];
% sx = [1,0.8,0.9,0.9];
% sy = [0.8,0.7];
% r = [0,0,0,0,0,0];
% z1 = gaussian_2(data1(:,1),data1(:,2),ux(:,1),uy(:,1),sx(:,1),sy(:,1),r(:,1));
% z2 = gaussian_2(data2(:,1),data2(:,2),ux(:,1),uy(:,2),sx(:,1),sy(:,2),r(:,2));
% z3 = gaussian_2(data3(:,1),data3(:,2),ux(:,2),uy(:,1),sx(:,2),sy(:,1),r(:,3));
% z4 = gaussian_2(data4(:,1),data4(:,2),ux(:,2),uy(:,2),sx(:,2),sy(:,2),r(:,4));
% z5 = gaussian_2(data5(:,1),data5(:,2),ux(:,3),uy(:,1),sx(:,3),sy(:,1),r(:,5));
% z6 = gaussian_2(data6(:,1),data6(:,2),ux(:,4),uy(:,2),sx(:,4),sy(:,2),r(:,5));
% z = [z1;z2;z3;z4;z5;z6];
% x1 = [data1(:,1);data2(:,1)];
% x2 = [data3(:,1);data4(:,1)];
% x3 = data5(:,1);
% x4 = data6(:,1);
% y1 = data1(:,2);
% y2 = data2(:,2);
% x_b = [x1;x2;x3;x4];
% x_e = data(:,1)';
% y_e = data(:,2)';
% fx1 = normpdf(x1,1,1);
% fx2 = normpdf(x2,5,0.64);
% fx3 = normpdf(x3,-3,0.81);
% fx4 = normpdf(x4,-6,0.81);
% fx = [fx1;fx2;fx3;fx4];
% figure(2)
% plot(x1,fx1,'b.');
% hold on;
% plot(x2,fx2,'r.');
% plot(x3,fx3,'g.');
% plot(x4,fx4,'k.');
% title('基本层数据服从一维混合高斯分布');
% figure(3)
% plot3(data1(:,1),data1(:, 2),z1,'b.');
% hold on;
% plot3(data2(:,1),data2(:,2),z2,'r.');
% plot3(data3(:,1),data3(:,2),z3,'g.');
% plot3(data4(:,1),data4(:,2),z4,'k.');
% plot3(data5(:,1),data5(:,2),z5,'m.');
% plot3(data6(:,1),data6(:,2),z6,'c.');
% title('增强层数据服从二维混合高斯分布');